<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LST - ุฅุดุงุฑุงุช โ ูุต</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/i18n.js"></script>
    <style>
    <style>
        /* Override body styles for embedded avatar display */
        body {
            background: var(--bg);
            min-height: 100vh;
            display: block;
            padding: 0;
        }

        .container {
            background: transparent;
            border-radius: 0;
            box-shadow: none;
            max-width: 100%;
            width: 100%;
            overflow: visible;
        }

        .main-content {
            padding: 30px;
        }

        .avatar-container {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .avatar {
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
            position: relative;
        }

        .avatar-body {
            width: 100%;
            height: 100%;
            background: #3498db;
            border-radius: 50% 50% 60% 60%;
            position: relative;
            animation: breathe 3s ease-in-out infinite;
        }

        .avatar-head {
            width: 120px;
            height: 120px;
            background: #f0c48c;
            border-radius: 50%;
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid #d4a574;
        }

        .avatar-eyes {
            display: flex;
            gap: 30px;
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
        }

        .eye {
            width: 15px;
            height: 15px;
            background: #2c3e50;
            border-radius: 50%;
            animation: blink 4s infinite;
        }

        .avatar-mouth {
            width: 40px;
            height: 20px;
            border: 3px solid #2c3e50;
            border-top: none;
            border-radius: 0 0 40px 40px;
            position: absolute;
            top: 75px;
            left: 50%;
            transform: translateX(-50%);
        }

        .hands {
            position: absolute;
            width: 100%;
            display: flex;
            justify-content: space-between;
            top: 120px;
        }

        .hand {
            width: 60px;
            height: 80px;
            background: #f0c48c;
            border-radius: 40% 40% 50% 50%;
            position: relative;
            transition: all 0.5s ease;
        }

        .hand.left {
            left: -30px;
            transform: rotate(-20deg);
        }

        .hand.right {
            right: -30px;
            transform: rotate(20deg);
        }

        .hand.signing {
            animation: signing 2s ease-in-out;
        }

        @keyframes signing {
            0%, 100% { transform: translateY(0) rotate(-20deg); }
            25% { transform: translateY(-20px) rotate(-40deg); }
            50% { transform: translateY(-10px) rotate(0deg); }
            75% { transform: translateY(-20px) rotate(20deg); }
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes blink {
            0%, 96%, 100% { height: 15px; }
            98% { height: 2px; }
        }

        .status-text {
            font-size: 18px;
            color: #2c3e50;
            margin-top: 20px;
            font-weight: 600;
        }

        .translation-text {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 20px;
            color: #667eea;
            font-weight: bold;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 200px;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }

        .btn-secondary:hover {
            background: #d5dbdb;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .phrases-section {
            margin-top: 30px;
        }

        .phrases-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .phrase-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .phrase-btn {
            padding: 12px 20px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            color: #2c3e50;
        }

        .phrase-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .recording {
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .info-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
        }

        .info-box p {
            color: #856404;
            margin: 0;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .category-tab {
            padding: 10px 20px;
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            color: #2c3e50;
            font-weight: 600;
        }

        .category-tab:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
        }

        .category-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .search-section {
            margin-top: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .phrase-count {
            text-align: center;
            color: #7f8c8d;
            margin-top: 15px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- Utility Bar -->
    <div class="utility-bar">
        <div class="utility-inner">
            <div class="logo-container">
                <video class="logo-video" autoplay muted loop playsinline>
                    <source src="/logo.mp4" type="video/mp4">
                </video>
            </div>
            <div class="brightness-group">
                <span class="brightness-label" data-i18n="brightness">ุงูุฅุถุงุกุฉ</span>
                <span class="bri-icon">๐</span>
                <input type="range" id="brightnessSlider" class="brightness-slider" min="50" max="130" value="100">
                <span class="bri-icon">โ๏ธ</span>
            </div>
            <div class="textsize-group">
                <span class="textsize-label" data-i18n="text_size">ุญุฌู ุงูุฎุท</span>
                <button class="size-btn" onclick="changeTextSize(-1)">A-</button>
                <button class="size-btn" onclick="changeTextSize(0)">A</button>
                <button class="size-btn" onclick="changeTextSize(1)">A+</button>
            </div>
            <div class="lang-group">
                <span class="lang-icon">๐</span>
                <button class="lang-btn active" data-lang="tn">ุฏุงุฑุฌุฉ</button>
                <button class="lang-btn" data-lang="fr">FR</button>
                <button class="lang-btn" data-lang="ar">ุนุฑุจู</button>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- Header -->
        <header class="compact-header">
            <h1>๐ค <span data-i18n="title">ูุชุฑุฌู ูุบุฉ ุงูุฅุดุงุฑุฉ ุงูุชููุณูุฉ</span></h1>
            <p class="header-sub" data-i18n="mode_camera">ุฅุดุงุฑุงุช โ ูุต</p>
        </header>

        <!-- Navigation -->
        <nav class="nav-bar-unified">
            <a href="/" class="nav-link-unified">
                <span>๐น</span>
                <span data-i18n="mode_video">ูุถุน ุงูููุฏูู</span>
            </a>
            <a href="/avatarr" class="nav-link-unified active">
                <span>๐ท</span>
                <span data-i18n="mode_camera">ุฅุดุงุฑุงุช โ ูุต</span>
            </a>
        </nav>

    <div class="container">
        <div class="main-content">
            <div class="avatar-container">
                <div class="avatar">
                    <div class="avatar-body">
                        <div class="avatar-head">
                            <div class="avatar-eyes">
                                <div class="eye"></div>
                                <div class="eye"></div>
                            </div>
                            <div class="avatar-mouth"></div>
                        </div>
                        <div class="hands">
                            <div class="hand left" id="leftHand"></div>
                            <div class="hand right" id="rightHand"></div>
                        </div>
                    </div>
                </div>
                <div class="status-text" id="statusText">ุงุถุบุท ุนูู ุงููููุฑูููู ููุจุฏุก</div>
                <div class="translation-text" id="translationText">ุงุณุชุนุฏ ููุชุฑุฌูุฉ...</div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="micBtn" onclick="startListening()">
                    ๐ค ุงุจุฏุฃ ุงูุงุณุชูุงุน
                </button>
                <button class="btn btn-secondary" id="stopBtn" onclick="stopListening()" disabled>
                    โน๏ธ ุฅููุงู
                </button>
            </div>

            <div class="phrases-section">
                <h3>๐ ูุงููุณ ุงูุนุจุงุฑุงุช ุงูุชููุณูุฉ - ุงุฎุชุฑ ูุฆุฉ:</h3>
                
                <div class="category-tabs">
                    <button class="category-tab active" onclick="showCategory('greetings')">๐ ุงูุชุญูุงุช</button>
                    <button class="category-tab" onclick="showCategory('questions')">โ ุฃุณุฆูุฉ</button>
                    <button class="category-tab" onclick="showCategory('responses')">๐ฌ ุฑุฏูุฏ</button>
                    <button class="category-tab" onclick="showCategory('emotions')">๐ ูุดุงุนุฑ</button>
                    <button class="category-tab" onclick="showCategory('food')">๐ฝ๏ธ ุทุนุงู</button>
                    <button class="category-tab" onclick="showCategory('family')">๐จโ๐ฉโ๐งโ๐ฆ ุนุงุฆูุฉ</button>
                    <button class="category-tab" onclick="showCategory('time')">โฐ ููุช</button>
                    <button class="category-tab" onclick="showCategory('all')">๐ ุงููู</button>
                </div>

                <div id="phrasesContainer" class="phrase-grid">
                    <!-- Phrases will be populated by JavaScript -->
                </div>

                <div class="search-section">
                    <input type="text" id="searchInput" class="search-input" placeholder="ุงุจุญุซ ุนู ุนุจุงุฑุฉ..." onkeyup="searchPhrases()">
                </div>
            </div>

            <div class="info-box">
                <p>๐ก ุงููุงููุณ ูุญุชูู ุนูู ุฃูุซุฑ ูู 100 ุนุจุงุฑุฉ ุชููุณูุฉ! ุงุณุชุฎุฏู ุงูุจุญุซ ุฃู ุงุฎุชุฑ ูุฆุฉ ูุนููุฉ</p>
            </div>
        </div>
    </div>
    </div> <!-- Close app-container -->

    <script src="/static/script.js"></script>
    <script>
        let recognition;
        let isListening = false;

        // Comprehensive Tunisian dialect sign language dictionary
        const signLanguageDictionary = {
            // Greetings - ุงูุชุญูุงุช
            'ุฃููุง': 'ุฑูุน ุงููุฏ ุงููููู ูุชุญุฑูููุง ููููุง ููุณุงุฑุง ุจุงุจุชุณุงูุฉ',
            'ูุฑุญุจุง': 'ุฑูุน ุงููุฏ ุงููููู ูุชุญุฑูููุง ููููุง ููุณุงุฑุง ุจุงุจุชุณุงูุฉ',
            'ุตุจุงุญ ุงูุฎูุฑ': 'ุฅุดุงุฑุฉ ุงูุดูุณ ุจุญุฑูุฉ ุฏุงุฆุฑูุฉ ุจุงููุฏ',
            'ูุณุงุก ุงูุฎูุฑ': 'ุฅุดุงุฑุฉ ุงูููุฑ ุจุญุฑูุฉ ูุตู ุฏุงุฆุฑุฉ',
            'ุชุตุจุญ ุนูู ุฎูุฑ': 'ูุถุน ุงููุฏูู ูุนุง ุฌุงูุจ ุงููุฌู ูุงูููู',
            'ุจุณูุงูุฉ': 'ุฑูุน ุงููุฏ ููุฃุนูู ูุชุญุฑูููุง ููููุง ููุณุงุฑุง',
            'ูุฏุงุนุง': 'ุฑูุน ุงููุฏ ููุฃุนูู ูุชุญุฑูููุง ููููุง ููุณุงุฑุง',
            
            // Common Questions - ุฃุณุฆูุฉ ุดุงุฆุนุฉ
            'ูููุงุด ุฑุงู': 'ุฅุดุงุฑุฉ ุงูุฅุตุจุน ูุญู ุงูุดุฎุต ุซู ูุถุน ุงููุฏ ุนูู ุงูููุจ',
            'ููู ุญุงูู': 'ุฅุดุงุฑุฉ ุงูุฅุตุจุน ูุญู ุงูุดุฎุต ุซู ูุถุน ุงููุฏ ุนูู ุงูููุจ',
            'ุดููุฉ ุฃุฎุจุงุฑู': 'ุฅุดุงุฑุฉ ุงูุณุคุงู ุจุฑูุน ุงููุฏูู ููุฃุนูู',
            'ุดุจูู': 'ุฅุดุงุฑุฉ ุงูุณุคุงู ุจุฅุตุจุน ุงูุณุจุงุจุฉ ูุญู ุงูุดุฎุต',
            'ูุงุด ุชุญุจ': 'ุฅุดุงุฑุฉ ุงูููุจ ุซู ุงูุณุคุงู ุจุญุฑูุฉ ุงููุฏ',
            'ููู ุฑุงูุญ': 'ุฅุดุงุฑุฉ ุงูุงุชุฌุงู ุจุฅุตุจุน ุงูุณุจุงุจุฉ',
            'ููุชุงุด': 'ุฅุดุงุฑุฉ ุงูุณุงุนุฉ ุจุญุฑูุฉ ุฏุงุฆุฑูุฉ ุนูู ุงููุนุตู',
            'ุดุญุงู': 'ุนุฏ ุจุงูุฃุตุงุจุน ุฃู ุฅุดุงุฑุฉ ุงููููุฉ',
            'ุนูุงุด': 'ุฅุดุงุฑุฉ ุงูุณุคุงู ุจูุฒ ุงููุชููู',
            
            // Responses - ุงูุฑุฏูุฏ
            'ุจุฎูุฑ ุงูุญูุฏ ููู': 'ุฑูุน ุงูุฅุจูุงู ููุฃุนูู ูุน ุงูุงุจุชุณุงูุฉ',
            'ูููุญ': 'ุฑูุน ุงูุฅุจูุงู ููุฃุนูู',
            'ูุงุณุฑ ูุฒูุงู': 'ุฑูุน ุงูุฅุจูุงููู ููุฃุนูู',
            'ูุงุดู ุจุงูู': 'ูุฒ ุงูุฑุฃุณ ูุฎูุถ ุงูุฅุจูุงู ููุฃุณูู',
            'ููุด ุจุงูู': 'ูุฒ ุงูุฑุฃุณ ูุฎูุถ ุงูุฅุจูุงู ููุฃุณูู',
            'ุจุฑุดุง': 'ุฑูุน ุงููุฏูู ููุฃุนูู ุจุญุฑูุฉ ูุงุณุนุฉ',
            'ุดููุฉ': 'ุฅุดุงุฑุฉ ุงูุดููุฉ ุจุงูุฅุตุจุนูู',
            'ูุง ููุงุด': 'ุชูุงุทุน ุงููุฏูู ุนูู ุดูู X',
            
            // Politeness - ุงูุฃุฏุจ
            'ุดูุฑุง': 'ูุถุน ุงููุฏ ุนูู ุงูููุจ ุซู ุชุญุฑูููุง ููุฃูุงู',
            'ูุนุทูู ุงูุตุญุฉ': 'ุฅุดุงุฑุฉ ุงูููุฉ ุจุซูู ุงูุฐุฑุงุน',
            'ูู ูุถูู': 'ูุถุน ุงููุฏูู ูุนุง ูุทูุจ',
            'ุนููุง': 'ูุถุน ุงููุฏ ุนูู ุงูุตุฏุฑ ูุงูุงูุญูุงุก ููููุง',
            'ุณุงูุญูู': 'ูุถุน ุงููุฏูู ุนูู ุงูุตุฏุฑ ูุน ุงูุงูุญูุงุก',
            'ุจุงูุทูุจ': 'ุฅุดุงุฑุฉ ุงูููุจ ุจุฑูู',
            
            // Yes/No - ูุนู/ูุง
            'ูุนู': 'ุฅููุงุกุฉ ุจุงูุฑุฃุณ ููุฃุณูู ูุงูุฃุนูู',
            'ุฅู': 'ุฅููุงุกุฉ ุจุงูุฑุฃุณ ููุฃุณูู ูุงูุฃุนูู',
            'ูุง': 'ูุฒ ุงูุฑุฃุณ ููููุง ููุณุงุฑุง',
            'ูุงูุง': 'ูุฒ ุงูุฑุฃุณ ููููุง ููุณุงุฑุง ูุน ุฑูุน ุงูุฅุตุจุน',
            
            // Understanding - ุงูููู
            'ูุง ูููุชุด': 'ูุฒ ุงูุฑุฃุณ ููุถุน ุงููุฏ ุนูู ุงูุฌุจูุฉ',
            'ูู ุฃููู': 'ูุฒ ุงูุฑุฃุณ ููุถุน ุงููุฏ ุนูู ุงูุฌุจูุฉ',
            'ูููุช': 'ุฅููุงุกุฉ ุจุงูุฑุฃุณ ูุน ุฑูุน ุงูุฅุจูุงู',
            'ุนุงูุฏ ููู': 'ุญุฑูุฉ ุฏุงุฆุฑูุฉ ุจุงููุฏ',
            'ุฃููู ุดููุฉ': 'ุฅุดุงุฑุฉ ุงูุดููุฉ ุจุงูุฃุตุงุจุน',
            
            // Emotions - ุงููุดุงุนุฑ
            'ูุญุจู': 'ูุถุน ุงููุฏูู ุนูู ุงูููุจ ุนูู ุดูู ููุจ',
            'ุฃุญุจู': 'ูุถุน ุงููุฏูู ุนูู ุงูููุจ ุนูู ุดูู ููุจ',
            'ูุฑุญุงู': 'ุฑูุน ุงููุฏูู ุจุงุจุชุณุงูุฉ ุนุฑูุถุฉ',
            'ุฒุนูุงู': 'ุนุจูุณ ูุน ุฎูุถ ุงูุฑุฃุณ',
            'ุชุนุจุงู': 'ูุถุน ุงููุฏ ุนูู ุงูุฌุจูุฉ',
            'ูุจุณูุท': 'ุงุจุชุณุงูุฉ ูุน ุฑูุน ุงูุฅุจูุงููู',
            
            // Family - ุงูุนุงุฆูุฉ
            'ุนุงุฆูุชู': 'ุชุดููู ุฏุงุฆุฑุฉ ุจุงููุฏูู',
            'ุฃูู': 'ุฅุดุงุฑุฉ ุงูุฃู ุจููุณ ุงูุฎุฏ',
            'ุฃุจู': 'ุฅุดุงุฑุฉ ุงูุฃุจ ุจููุณ ุงูุฐูู',
            'ุฎููุง': 'ุฅุดุงุฑุฉ ุงูุฃุฎ ุจุฑูุน ุงููุฏ',
            'ุฎุชู': 'ุฅุดุงุฑุฉ ุงูุฃุฎุช ุจููุณ ุงูุดุนุฑ',
            
            // Food & Drink - ุงูุทุนุงู ูุงูุดุฑุงุจ
            'ูุงููุฉ': 'ุญุฑูุฉ ุงูุฃูู ุจุชูุฑูุจ ุงููุฏ ูู ุงููู',
            'ุดุฑุจุฉ': 'ุญุฑูุฉ ุงูุดุฑุจ ุจุฅูุงูุฉ ุงููุฏ',
            'ูุณูุณู': 'ุญุฑูุฉ ุฏุงุฆุฑูุฉ ุจุงููุฏูู',
            'ุจุฑู': 'ุฅุดุงุฑุฉ ุงูุดุงู ุจุฑูุน ุงููุฃุณ ูููู',
            'ูููุฉ': 'ุญุฑูุฉ ุทุญู ุงููููุฉ',
            'ุฎุจุฒ': 'ุญุฑูุฉ ูุณุฑ ุงูุฎุจุฒ',
            'ุฌูุน': 'ูุถุน ุงููุฏ ุนูู ุงูุจุทู',
            'ุนุทุดุงู': 'ุฅุดุงุฑุฉ ุงูุญูู',
            'ุดุจุนุช': 'ุฑูุน ุงููุฏ ูุน ุงูุฑูุถ',
            
            // Time - ุงูููุช
            'ุฏุงุจุง': 'ุฅุดุงุฑุฉ ููุญุธุฉ ุงูุญุงููุฉ ุจุฅุตุจุน ุงูุณุจุงุจุฉ',
            'ุชูุง': 'ุฅุดุงุฑุฉ ููุญุธุฉ ุงูุญุงููุฉ ุจุฅุตุจุน ุงูุณุจุงุจุฉ',
            'ุจุฑูุฉ': 'ุฅุดุงุฑุฉ ุงูุงูุชุธุงุฑ ุจุฑูุน ุงูุฅุตุจุน',
            'ููุณุน': 'ุญุฑูุฉ ุณุฑูุนุฉ ุจุงููุฏ',
            'ุงูููู': 'ุฅุดุงุฑุฉ ุงูุดูุณ ูู ููุชุตู ุงูุณูุงุก',
            'ุงูุจุงุฑุญ': 'ุฅุดุงุฑุฉ ููุฎูู ููู ุงููุชู',
            'ุบุฏูุฉ': 'ุฅุดุงุฑุฉ ููุฃูุงู',
            
            // Places - ุงูุฃูุงูู
            'ุชููุณ ุงูุฎุถุฑุงุก': 'ุฅุดุงุฑุฉ ุงูุฎุฑูุทุฉ ุซู ุฅุดุงุฑุฉ ุงูููู ุงูุฃุฎุถุฑ',
            'ุฏุงุฑ': 'ุชุดููู ุณูู ุจููุฉ ุงููุฏูู',
            'ุดุงุฑุน': 'ุญุฑูุฉ ุงูุทุฑูู ุจุงูุชุฏุงุฏ ุงููุฏูู',
            'ุณูู': 'ุญุฑูุฉ ุงูุชุจุงุฏู ุจุงููุฏูู',
            'ุฌุงูุน': 'ุฅุดุงุฑุฉ ุงูููุงุฑุฉ ููุฃุนูู',
            
            // Common Verbs - ุฃูุนุงู ุดุงุฆุนุฉ
            'ููุดู': 'ุญุฑูุฉ ุงููุดู ุจุฅุตุจุนูู',
            'ูุฌู': 'ุฅุดุงุฑุฉ ุงููุฌูุก ุจุชูุฑูุจ ุงููุฏ',
            'ูุนูู': 'ุญุฑูุฉ ุงูุนูู ุจุชุญุฑูู ุงููุฏูู',
            'ููุฑุง': 'ุญุฑูุฉ ุงููุฑุงุกุฉ ุจูุชุญ ูุชุงุจ ูููู',
            'ููุชุจ': 'ุญุฑูุฉ ุงููุชุงุจุฉ ุจุงูููู',
            'ูุดูู': 'ุฅุดุงุฑุฉ ููุนูููู',
            'ูุณูุน': 'ุฅุดุงุฑุฉ ููุฃุฐููู',
            
            // Weather - ุงูุทูุณ
            'ุดูุณ': 'ุญุฑูุฉ ุฏุงุฆุฑูุฉ ุจุฅุดุงุฑุฉ ุงูุดูุณ',
            'ุดุชุงุก': 'ุฅุดุงุฑุฉ ุงูุจุฑุฏ ุจุงูุงุฑุชุฌุงู',
            'ุตูู': 'ุฅุดุงุฑุฉ ุงูุญุฑุงุฑุฉ ุจูุณุญ ุงูุฌุจูู',
            'ุดุชู': 'ุญุฑูุฉ ุงููุทุฑ ุจุงูุฃุตุงุจุน ูู ุงูุฃุนูู',
            
            // Numbers expressions - ุชุนุจูุฑุงุช ุงูุฃุฑูุงู
            'ูุงุญุฏ': 'ุฑูุน ุฅุตุจุน ูุงุญุฏ',
            'ุฒูุฒ': 'ุฑูุน ุฅุตุจุนูู',
            'ุซูุงุซุฉ': 'ุฑูุน ุซูุงุซุฉ ุฃุตุงุจุน',
            'ุจุฑุดุง': 'ุฑูุน ุงููุฏูู ููุฃุนูู ุจุญุฑูุฉ ูุงุณุนุฉ',
            
            // Common expressions - ุชุนุจูุฑุงุช ุดุงุฆุนุฉ
            'ุนูุฏู ุงูุญู': 'ุฑูุน ุงูุฅุจูุงู ููุฃุนูู',
            'ุฅู ุดุงุก ุงููู': 'ุฑูุน ุฅุตุจุน ุงูุณุจุงุจุฉ ููุณูุงุก',
            'ุงูุญูุฏ ููู': 'ูุถุน ุงููุฏ ุนูู ุงูููุจ',
            'ูุงุดู ูุดูู': 'ุฑูุน ุงููุฏ ุจุญุฑูุฉ ุงูููุงููุฉ',
            'ุนุงุฏู': 'ุญุฑูุฉ ุงููุฏ ุงููุณุชููุฉ',
            'ูุง ุณูุงู': 'ุฑูุน ุงููุฏูู ุจุชุนุฌุจ',
            'ุจุงููู': 'ุญุฑูุฉ ุงูุฏุนุงุก ุจุงููุฏูู',
            'ุฑุจู ูุนููู': 'ุฑูุน ุงููุฏูู ููุฏุนุงุก',
            
            // Technology - ุงูุชูููููุฌูุง
            'ุชูููููู': 'ุฅุดุงุฑุฉ ุงููุงุชู ุจุงููุฏ ุนูู ุงูุฃุฐู',
            'ููุจููุชุฑ': 'ุญุฑูุฉ ุงููุชุงุจุฉ ุนูู ููุญุฉ ุงูููุงุชูุญ',
            'ุงูุชุฑูุช': 'ุญุฑูุฉ ุงูุงุชุตุงู ุงูุนุงููู',
            
            // Health - ุงูุตุญุฉ
            'ูุฑูุถ': 'ูุถุน ุงููุฏ ุนูู ุงูุฌุจูุฉ ุจุชุนุจ',
            'ุทุจูุจ': 'ุฅุดุงุฑุฉ ุงูุณูุงุนุฉ ุงูุทุจูุฉ',
            'ุฏูุงุก': 'ุญุฑูุฉ ุชูุงูู ุงูุญุจูุจ',
            'ูุฑุชุงุญ': 'ุญุฑูุฉ ุงูุฑุงุญุฉ ูุงูุงุณุชุฑุฎุงุก'
        };

        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'ar-TN'; // Tunisian Arabic

                recognition.onstart = function() {
                    isListening = true;
                    document.getElementById('statusText').textContent = 'ุฌุงุฑู ุงูุงุณุชูุงุน... ุชููู ุจุงูุฏุงุฑุฌุฉ ุงูุชููุณูุฉ';
                    document.getElementById('micBtn').disabled = true;
                    document.getElementById('stopBtn').disabled = false;
                    document.getElementById('micBtn').classList.add('recording');
                };

                recognition.onresult = function(event) {
                    let finalTranscript = '';
                    
                    for (let i = event.resultIndex; i < event.results.length; ++i) {
                        if (event.results[i].isFinal) {
                            finalTranscript += event.results[i][0].transcript;
                        }
                    }

                    if (finalTranscript) {
                        translatePhrase(finalTranscript.trim());
                    }
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    document.getElementById('statusText').textContent = 'ุฎุทุฃ: ' + event.error;
                    stopListening();
                };

                recognition.onend = function() {
                    if (isListening) {
                        recognition.start(); // Restart if still listening
                    }
                };
            } else {
                alert('ุนุฐุฑุงุ ุงููุชุตูุญ ูุง ูุฏุนู ุงูุชุนุฑู ุนูู ุงูุตูุช. ุฌุฑุจ Chrome ุฃู Edge.');
            }
        }

        function startListening() {
            if (!recognition) {
                initSpeechRecognition();
            }
            if (recognition && !isListening) {
                recognition.start();
            }
        }

        function stopListening() {
            isListening = false;
            if (recognition) {
                recognition.stop();
            }
            document.getElementById('statusText').textContent = 'ุชููู ุงูุงุณุชูุงุน';
            document.getElementById('micBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('micBtn').classList.remove('recording');
        }

        function translatePhrase(phrase) {
            console.log('Translating:', phrase);
            
            // Normalize the phrase
            const normalizedPhrase = phrase.trim().toLowerCase();
            
            // Search for matching sign
            let signDescription = null;
            for (const [key, value] of Object.entries(signLanguageDictionary)) {
                if (normalizedPhrase.includes(key.toLowerCase()) || key.toLowerCase().includes(normalizedPhrase)) {
                    signDescription = value;
                    break;
                }
            }

            // Display results
            if (signDescription) {
                document.getElementById('translationText').textContent = signDescription;
                document.getElementById('statusText').textContent = 'โ ุชูุช ุงูุชุฑุฌูุฉ: ' + phrase;
                animateSigning();
            } else {
                document.getElementById('translationText').textContent = 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุชุฑุฌูุฉ ููุฐู ุงูุนุจุงุฑุฉ';
                document.getElementById('statusText').textContent = 'โ ุนุจุงุฑุฉ ุบูุฑ ููุฌูุฏุฉ ูู ุงููุงููุณ: ' + phrase;
            }
        }

        function animateSigning() {
            const leftHand = document.getElementById('leftHand');
            const rightHand = document.getElementById('rightHand');
            
            // Add signing animation
            leftHand.classList.add('signing');
            rightHand.classList.add('signing');
            
            // Remove animation after completion
            setTimeout(() => {
                leftHand.classList.remove('signing');
                rightHand.classList.remove('signing');
            }, 2000);
        }

        // Categorized phrases
        const phraseCategories = {
            greetings: ['ุฃููุง', 'ูุฑุญุจุง', 'ุตุจุงุญ ุงูุฎูุฑ', 'ูุณุงุก ุงูุฎูุฑ', 'ุชุตุจุญ ุนูู ุฎูุฑ', 'ุจุณูุงูุฉ', 'ูุฏุงุนุง'],
            questions: ['ูููุงุด ุฑุงู', 'ููู ุญุงูู', 'ุดููุฉ ุฃุฎุจุงุฑู', 'ุดุจูู', 'ูุงุด ุชุญุจ', 'ููู ุฑุงูุญ', 'ููุชุงุด', 'ุดุญุงู', 'ุนูุงุด'],
            responses: ['ุจุฎูุฑ ุงูุญูุฏ ููู', 'ูููุญ', 'ูุงุณุฑ ูุฒูุงู', 'ูุงุดู ุจุงูู', 'ููุด ุจุงูู', 'ุจุฑุดุง', 'ุดููุฉ', 'ูุง ููุงุด', 'ูุนู', 'ุฅู', 'ูุง', 'ูุงูุง'],
            emotions: ['ูุญุจู', 'ุฃุญุจู', 'ูุฑุญุงู', 'ุฒุนูุงู', 'ุชุนุจุงู', 'ูุจุณูุท'],
            food: ['ูุงููุฉ', 'ุดุฑุจุฉ', 'ูุณูุณู', 'ุจุฑู', 'ูููุฉ', 'ุฎุจุฒ', 'ุฌูุน', 'ุนุทุดุงู', 'ุดุจุนุช'],
            family: ['ุนุงุฆูุชู', 'ุฃูู', 'ุฃุจู', 'ุฎููุง', 'ุฎุชู'],
            time: ['ุฏุงุจุง', 'ุชูุง', 'ุจุฑูุฉ', 'ููุณุน', 'ุงูููู', 'ุงูุจุงุฑุญ', 'ุบุฏูุฉ'],
            politeness: ['ุดูุฑุง', 'ูุนุทูู ุงูุตุญุฉ', 'ูู ูุถูู', 'ุนููุง', 'ุณุงูุญูู', 'ุจุงูุทูุจ'],
            understanding: ['ูุง ูููุชุด', 'ูู ุฃููู', 'ูููุช', 'ุนุงูุฏ ููู', 'ุฃููู ุดููุฉ'],
            places: ['ุชููุณ ุงูุฎุถุฑุงุก', 'ุฏุงุฑ', 'ุดุงุฑุน', 'ุณูู', 'ุฌุงูุน'],
            verbs: ['ููุดู', 'ูุฌู', 'ูุนูู', 'ููุฑุง', 'ููุชุจ', 'ูุดูู', 'ูุณูุน'],
            weather: ['ุดูุณ', 'ุดุชุงุก', 'ุตูู', 'ุดุชู'],
            numbers: ['ูุงุญุฏ', 'ุฒูุฒ', 'ุซูุงุซุฉ', 'ุจุฑุดุง'],
            expressions: ['ุนูุฏู ุงูุญู', 'ุฅู ุดุงุก ุงููู', 'ุงูุญูุฏ ููู', 'ูุงุดู ูุดูู', 'ุนุงุฏู', 'ูุง ุณูุงู', 'ุจุงููู', 'ุฑุจู ูุนููู'],
            technology: ['ุชูููููู', 'ููุจููุชุฑ', 'ุงูุชุฑูุช'],
            health: ['ูุฑูุถ', 'ุทุจูุจ', 'ุฏูุงุก', 'ูุฑุชุงุญ']
        };

        let currentCategory = 'greetings';
        let allPhrases = [];

        function initializePhrases() {
            // Create a flat list of all phrases
            allPhrases = Object.values(phraseCategories).flat();
            showCategory('greetings');
        }

        function showCategory(category) {
            currentCategory = category;
            const container = document.getElementById('phrasesContainer');
            container.innerHTML = '';

            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event?.target?.classList.add('active');

            let phrasesToShow = [];
            if (category === 'all') {
                phrasesToShow = allPhrases;
            } else if (phraseCategories[category]) {
                phrasesToShow = phraseCategories[category];
            }

            phrasesToShow.forEach(phrase => {
                const btn = document.createElement('button');
                btn.className = 'phrase-btn';
                btn.textContent = phrase;
                btn.onclick = () => translatePhrase(phrase);
                container.appendChild(btn);
            });

            // Add phrase count
            const countDiv = document.createElement('div');
            countDiv.className = 'phrase-count';
            countDiv.textContent = `ุนุฏุฏ ุงูุนุจุงุฑุงุช: ${phrasesToShow.length}`;
            container.appendChild(countDiv);
        }

        function searchPhrases() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const container = document.getElementById('phrasesContainer');
            container.innerHTML = '';

            if (!searchTerm) {
                showCategory(currentCategory);
                return;
            }

            const matchedPhrases = allPhrases.filter(phrase => 
                phrase.toLowerCase().includes(searchTerm)
            );

            if (matchedPhrases.length === 0) {
                container.innerHTML = '<div class="phrase-count">ูู ูุชู ุงูุนุซูุฑ ุนูู ุนุจุงุฑุงุช ูุทุงุจูุฉ</div>';
                return;
            }

            matchedPhrases.forEach(phrase => {
                const btn = document.createElement('button');
                btn.className = 'phrase-btn';
                btn.textContent = phrase;
                btn.onclick = () => translatePhrase(phrase);
                container.appendChild(btn);
            });

            const countDiv = document.createElement('div');
            countDiv.className = 'phrase-count';
            countDiv.textContent = `ูุชุงุฆุฌ ุงูุจุญุซ: ${matchedPhrases.length}`;
            container.appendChild(countDiv);
        }

        // Initialize on page load
        window.onload = function() {
            // Initialize i18n
            if (typeof I18N !== 'undefined') {
                I18N.init();
            }
            initSpeechRecognition();
            initializePhrases();
        };
    </script>
</body>
</html>